# 09. 持久化、主从复制与高可用

## 1. RDB

- 快照持久化
- 优点：恢复快
- 风险：两次快照之间可能丢数据

## 2. AOF

- 追加写命令日志
- `appendfsync` 策略影响数据安全与性能
- AOF 重写（rewrite）减少文件体积

## 3. 主从复制

- 全量复制 + 增量复制
- 风险：复制延迟导致读到旧数据

## 4. 哨兵（Sentinel）

- 监控主节点、故障转移、选主
- 风险：脑裂（网络分区）

## 5. 工程落地建议

- 明确“允许丢多少数据”决定 RDB/AOF 策略
- 重要业务关注：复制延迟、故障转移时间、客户端重连策略
