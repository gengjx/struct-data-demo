# 事务与锁考核

要求：每题给出 SQL 及说明。涉及并发的题可以用两个会话模拟。

1. 用两个会话演示：在默认隔离级别下（MySQL 8 InnoDB 默认 RR），同一行的并发更新会发生什么？
2. 写出一次“扣减库存”的事务 SQL：
   - `inventory.available` 不能扣成负数
   - 并发下不超卖
   说明你使用了悲观锁还是乐观锁。
3. 写出 `SELECT ... FOR UPDATE` 的使用场景，并解释它会锁住什么。
4. 死锁：描述一种典型死锁形成方式（两张表或同一张表不同顺序），并写出避免策略。
5. 长事务风险：说明长事务会带来哪些问题（至少列 3 点），以及如何治理。
